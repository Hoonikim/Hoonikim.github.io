---
layout: single
title: "[Network] CORSì™€ SOP"
categories: Network
tags: [ Network, CodeStates]
toc: true

---

### 2022.12.08

### ğŸ’¡  CORSì™€ SOP

ìƒˆë¡œ ë°°ìš°ëŠ” ê°œë…ì¸ CORSì™€ SOP 

í”„ë¡ íŠ¸ì—ì„œë„ ê¸°ë³¸ì ì¸ ì„œë²„ ê´€ë ¨ ê³µë¶€ë¥¼ ê¼­ í•´ì•¼í•œë‹¤ëŠ” ê±´ ì´ì œ ëˆ„êµ¬ë‚˜ ì•„ëŠ” ì‚¬ì‹¤ì´ë‹¤. 

ì½˜ì†”ì°½ì—ì„œ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ë¥¼ ì¢…ì¢… ë³´ê³ ëŠ” í•œë‹¤. ì´ ì—ëŸ¬ê°€ ë°”ë¡œ CORSì—ëŸ¬ë¡œ CORSê°€ í•„ìš”í•˜ê²Œ ëœ ë°°ê²½ì¸ SOPì— ëŒ€í•´ ì•Œì•„ë‘˜ í•„ìš”ê°€ ìˆë‹¤. 

![ìŠ¤í¬ë¦°ìƒ· 2022-12-08 20 14 01](https://user-images.githubusercontent.com/104547038/206432867-0c171ab8-b4f0-4a03-ae7a-6381b26642b8.png)

#### ğŸ“Œ SOP

SOPì€ **Same-Origin Policy**ì˜ ì¤„ì„ë§ë¡œ, ë™ì¼ ì¶œì²˜ ì •ì±…ì„ ëœ»í•œë‹¤.

ì¦‰ **ê°™ì€ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ë§Œ ê³µìœ ê°€ ê°€ëŠ¥í•˜ë‹¤**ë¼ëŠ” ëœ»ì¸ë° ì—¬ê¸°ì„œ ë§í•˜ëŠ” ì¶œì²˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. 

![ìŠ¤í¬ë¦°ìƒ· 2022-12-08 20 15 57](https://user-images.githubusercontent.com/104547038/206433243-04d190f2-45f4-435f-b59f-62524631b0c7.png)

ì¶œì²˜ëŠ” **í”„ë¡œí† ì½œ, í˜¸ìŠ¤íŠ¸, í¬íŠ¸**ì˜ ì¡°í•©ìœ¼ë¡œ ë˜ì–´ìˆìŠµë‹ˆë‹¤. ì´ ì¤‘ **í•˜ë‚˜ë¼ë„ ë‹¤ë¥´ë©´** ë™ì¼í•œ ì¶œì²˜ë¡œ ë³´ì§€ ì•ŠëŠ”ë‹¤. 

ì˜ˆì‹œë¥¼ ë“¤ìë©´

- `https://www.codestates.com` **vs** `http://www.codestates.com` â‡’ ë‘ URIëŠ” **í”„ë¡œí† ì½œ**ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë™ì¼ ì¶œì²˜ âŒ ( https / http )

- `https://urclass.codestates.com` **vs** `https://codestates.com` â‡’ ë‘ URIëŠ” **í˜¸ìŠ¤íŠ¸**ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë™ì¼ ì¶œì²˜ âŒ ( urclass.codestates.com / codestates.com )

- ` http://codestates.com:81` **vs** `http://codestates.com`

  http í”„ë¡œí† ì½œì˜ ê¸°ë³¸ í¬íŠ¸ëŠ” 80ì´ë‹¤. ë”°ë¼ì„œ `http://codestates.com` ëŠ” `http://codestates.com:80` ê³¼ ë™ì¼. â‡’ ë‘ URIëŠ” **í¬íŠ¸**ê°€ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ë™ì¼ ì¶œì²˜ âŒ ( :81 / :80 )

- `https://codestates.com:443 ` **vs** `https://codestates.com`

  https í”„ë¡œí† ì½œì˜ ê¸°ë³¸ í¬íŠ¸ëŠ” 443ì´ë‹¤. ë”°ë¼ì„œ `https://codestates.com` ëŠ” `https://codestates.com:443` ê³¼ ë™ì¼í•˜ë‹¤. â‡’ ë‘ URIëŠ” í”„ë¡œí† ì½œ, í˜¸ìŠ¤íŠ¸, í¬íŠ¸ê°€ ëª¨ë‘ ê°™ì€ **ë™ì¼ ì¶œì²˜**ğŸ™†â€â™‚ï¸

ğŸ§ ê·¸ë ‡ë‹¤ë©´ ì™œ? SOPì€ ìƒê²¨ë‚œê±¸ê¹Œ? 

> ë™ì¼ ì¶œì²˜ ì •ì±…ì€ ì ì¬ì ìœ¼ë¡œ í•´ë¡œìš¸ ìˆ˜ ìˆëŠ” ë¬¸ì„œë¥¼ ë¶„ë¦¬í•¨ìœ¼ë¡œì¨ ê³µê²©ë°›ì„ ìˆ˜ ìˆëŠ” ê²½ë¡œë¥¼ ì¤„ì—¬ì¤€ë‹¤. 
>
> ë‹¤ë¥¸ ì‚¬ì´íŠ¸ì™€ì˜ ë¦¬ì†ŒìŠ¤ ê³µìœ ë¥¼ ì œí•œí•˜ê¸° ë•Œë¬¸ì— ë¡œê·¸ì¸ ì •ë³´ì™€ ê°™ì´ ë¯¼ê°í•œ ì •ë³´ê°€ íƒ€ì‚¬ì´íŠ¸ì˜ ì½”ë“œì— ì˜í•˜ì—¬ ìƒˆì–´ë‚˜ê°€ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. 

í•˜ì§€ë§Œ í˜„ì‹¤ì—ì„œëŠ” ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•  ì¼ì´ êµ‰ì¥íˆ ë§ë‹¤. **ê·¸ë ‡ë‹¤ë©´ ì–´ë–»ê²Œ** ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆëŠ” ê±¸ê¹Œ? ê·¸ ë‹µì€ ë°”ë¡œ ì•„ë˜ì— ìˆë‹¤. 

#### ğŸ“Œ CORS

 CORSëŠ” **Cross-Origin Resource Sharing**ì˜ ì¤„ì„ë§ë¡œ êµì°¨ ì¶œì²˜ ë¦¬ì†ŒìŠ¤ ê³µìœ ë¥¼ ëœ»í•œë‹¤.

ë¸Œë¼ìš°ì €ëŠ” SOPì— ì˜í•´ ê¸°ë³¸ì ìœ¼ë¡œ ë‹¤ë¥¸ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ ê³µìœ ë¥¼ ë§‰ì§€ë§Œ, CORSë¥¼ ì‚¬ìš©í•˜ë©´ ì ‘ê·¼ ê¶Œí•œì„ ì–»ì„ ìˆ˜ ìˆê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.

Request ìš”ì²­ - GET, POST, PUT, PATCH, DELETE, OPTIONS, URL( /upper, /lower )...    && í—¤ë” ë°”ë””

> GETì€ ì„œë²„ì˜ ë¦¬ì†ŒìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ìš”ì²­í•  ë•Œ, POSTëŠ” ì„œë²„ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒˆë¡œ ìƒì„±í•  ë•Œ, PUT & PATCHëŠ” ì—…ë°ì´íŠ¸í•  ë•Œ 

Response - 200 400 ... && í—¤ë” ë°”ë””

##### ğŸ‘¨ğŸ»â€ğŸ’» CORSì˜ ë™ì‘ ë°©ì‹

CORSì˜ ë™ì‘ ë°©ì‹ì€ í¬ê²Œ 3ê°€ì§€ê°€ ìˆëŠ”ë° 

* í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ ( Preflight Request )

 ì‹¤ì œ ìš”ì²­ì„ ë³´ë‚´ê¸° ì „ OPTIONS ë©”ì„œë“œë¡œ ì‚¬ì „ìš”ì²­ì„ ë³´ë‚´ì„œ ì ‘ê·¼ ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•ì´ë‹¤. => ì²˜ìŒë¶€í„° í†µì§¸ë¡œ ìš”ì²­ì„ ë³´ë‚´ëŠ” ê²ƒë³´ë‹¤ íš¨ìœ¨ì 

![ìŠ¤í¬ë¦°ìƒ· 2022-12-08 20 25 59](https://user-images.githubusercontent.com/104547038/206435076-8f012b15-91da-411c-ad96-45fbc909f101.png)

![ìŠ¤í¬ë¦°ìƒ· 2022-12-08 20 26 53](https://user-images.githubusercontent.com/104547038/206435237-b4c4bcd5-05cd-4f1f-9fb3-8ad46c0ff75b.png)



* ë‹¨ìˆœ ìš”ì²­ ( Simple Request )

íŠ¹ì • ì¡°ê±´ë§Œ ë§Œì¡±ë˜ë©´ í”„ë¦¬í”Œë¼ì´íŠ¸ ìš”ì²­ì„ ìƒëµí•˜ê³  ìš”ì²­ì„ ë°”ë¡œ ë³´ë‚´ëŠ” ê²ƒ 

![ìŠ¤í¬ë¦°ìƒ· 2022-12-08 20 27 37](https://user-images.githubusercontent.com/104547038/206435370-4c314943-c139-4058-bf75-eb028f9dc90d.png)

* ì¸ì¦ ì •ë³´ë¥¼ í¬í•¨í•œ ìš”ì²­ 

ìš”ì²­ í—¤ë”ì— ì¸ì¦ ì •ë³´ë¥¼ ë‹´ì•„ ë³´ë‚´ëŠ” ìš”ì²­, ì¶œì²˜ê°€ ë‹¤ë¥¼ ê²½ìš°ì—ëŠ” ë³„ë„ì˜ ì„¤ì •ì„ í•˜ì§€ ì•Šìœ¼ë©´ ì¿ í‚¤ë¥¼ ë³´ë‚¼ ìˆ˜ ì—†ë‹¤( ë¯¼ê°í•œ ì •ë³´ì´ê¸° ë•Œë¬¸ ) ì´ ê²½ìš°ì—ëŠ” **í”„ë¡ íŠ¸, ì„œë²„ ì–‘ì¸¡ ëª¨ë‘ CORS ì„¤ì •ì´ í•„ìš”**

- **í”„ë¡ íŠ¸** ì¸¡ì—ì„œëŠ” ìš”ì²­ í—¤ë”ì— `withCredentials : true` ë¥¼ 
- **ì„œë²„** ì¸¡ì—ì„œëŠ” ì‘ë‹µ í—¤ë”ì— `Access-Control-Allow-Credentials : true` ë¥¼ ë„£ì–´ì¤˜ì•¼ í•œë‹¤.
- ì„œë²„ ì¸¡ì—ì„œ `Access-Control-Allow-Origin` ì„ ì„¤ì •í•  ë•Œ, ëª¨ë“  ì¶œì²˜ë¥¼ í—ˆìš©í•œë‹¤ëŠ” ëœ»ì˜ ì™€ì¼ë“œì¹´ë“œ(*)ë¡œ ì„¤ì •í•˜ë©´ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. ì¸ì¦ ì •ë³´ë¥¼ ë‹¤ë£¨ëŠ” ë§Œí¼ ì¶œì²˜ë¥¼ ì •í™•í•˜ê²Œ ì„¤ì •í•´ì£¼ì–´ì•¼ í•œë‹¤.

##### ğŸ‘¨ğŸ»â€ğŸ’» CORSì˜ ì„¤ì • ë°©ë²•

* Node.js ì„œë²„ 

  Node.jsë¡œ ê°„ë‹¨í•œ HTTP ì„œë²„ë¥¼ ë§Œë“¤ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì‘ë‹µ í—¤ë”ë¥¼ ì„¤ì •í•´ ì¤„ ìˆ˜ ìˆë‹¤. 

  ```react
  const http = require('http');
  
  const server = http.createServer((request, response) => {
  // ëª¨ë“  ë„ë©”ì¸
    response.setHeader("Access-Control-Allow-Origin", "*");
  
  // íŠ¹ì • ë„ë©”ì¸
    response.setHeader("Access-Control-Allow-Origin", "https://codestates.com");
  
  // ì¸ì¦ ì •ë³´ë¥¼ í¬í•¨í•œ ìš”ì²­ì„ ë°›ì„ ê²½ìš°
    response.setHeader("Access-Control-Allow-Credentials", "true");
  })
  ```

  

* Express ì„œë²„

  Express í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•´ì„œ ì„œë²„ë¥¼ ë§Œë“œëŠ” ê²½ìš° CORS ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•´ì„œ ë³´ë‹¤ ê°„ë‹¨í•˜ê²Œ CORS ì„¤ì •ì„ í•´ì¤„ ìˆ˜ ìˆë‹¤. 

  ```react
  const cors = require("cors");
  const app = express();
  
  //ëª¨ë“  ë„ë©”ì¸
  app.use(cors());
  
  //íŠ¹ì • ë„ë©”ì¸
  const options = {
    origin: "https://codestates.com", // ì ‘ê·¼ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ” ë„ë©”ì¸
    credentials: true, // ì‘ë‹µ í—¤ë”ì— Access-Control-Allow-Credentials ì¶”ê°€
    optionsSuccessStatus: 200, // ì‘ë‹µ ìƒíƒœ 200ìœ¼ë¡œ ì„¤ì •
  };
  
  app.use(cors(options));
  
  //íŠ¹ì • ìš”ì²­
  app.get("/example/:id", cors(), function (req, res, next) {
    res.json({ msg: "example" });
  });
  ```

  

