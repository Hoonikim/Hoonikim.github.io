---
layout: single
title: "[React] State 끌어올리기"
categories: React
tags: [ React, CodeStates]
toc: true


---

### 2022.12.06

### 💡  React 데이터의 흐름과  State 끌어올리기

#### 📌 React 데이터의 흐름

React 개발 방식의 가장 큰 특징은 페이지 단위가 아닌, 컴포넌트 단위로 시작한다는 점이 가장 큰 특징이다. 

페이지를 만들기 이전에 컴포넌트를 먼저 만들고 조립한다. 

![스크린샷 2022-12-06 21 42 49](https://user-images.githubusercontent.com/104547038/205915745-bc076816-391e-4e94-87a5-ef61a6edaa50.png)

위의 그림에서 NewTweetForm과 SingleTweet은 같은 Twittler컴포넌트 안에 속해있다. 

![스크린샷 2022-12-06 21 44 52](https://user-images.githubusercontent.com/104547038/205916173-55eb86a2-8160-45b1-9bc5-76c161008c78.png)

이런식으로 나누어진 이유는 무엇일까? 그것은 오늘 공부의 핵심이라고 생각하는 **단일 책임 원칙**에 따른 구분이다. 

즉, 두 개의 자식 컴포넌트가 하나의 상태에 접근하고 할 때는 두 자식의 공통 부모 컴포넌트에 상태를 위치해야 한다. 

--------------------------

여기서 잠시 복습할 포인트는 

> 하나의 컴포넌트는 한 가지 일만 한다. 
>
> 데이터는 위에서 아래로 흐른다. 

![스크린샷 2022-12-06 21 55 42](https://user-images.githubusercontent.com/104547038/205918474-7ad313d9-e713-4c63-98a6-3b488bf77702.png)

컴포넌트는 컴포넌트 바깥에서 props를 이용해 데이터를 마치 전달인자(argument) 혹은 속성(attributes)처럼 전달받을 수 있다. 

즉 데이터를 전달하는 주체는 부모 컴포넌트가 된다. 이는 데이터 흐름이 하향식(top-down)임을 의미

![스크린샷 2022-12-06 21 56 58](https://user-images.githubusercontent.com/104547038/205918768-69961566-1d2d-4cb9-9b31-e8d7fff2c18c.png)

----------------------------------

그렇다면 만약 새로운 tweet이 있다고 했을 때 이는 어떤 컴포넌트로 이동해야 할까?

위의 그림에서 `트윗` 버튼을 눌렀을 때 새로운 트윗을 추가하려면 부모 컴포넌트에서의 상태가 하위 컴포넌트에 의해 변하는 것을 발견할 수 있다. 

이는 역방향의 데이터 흐름이 아닌가? 맞다 버튼을 통한 이 액션은, 부모의 상태를 변화시켜야 한다. 

단방향 데이터 흐름을 따르면서 어떻게 역방향을 해결할 수 있냐고 생각할 수 있다. 이를 해결하기 위한 방법이 아래에 설명되어 있다. 



#### 📌 State 끌어올리기

> 상태를 변경시키는 함수 ( Handler )를 하위 컴포넌트에 props로 전달해서 해결할 수 있다. 이는 마치 콜백 함수를 사용하는 방법과 비슷하다. 

이 파트를 공부할 때 그 어떠한 100마디 말보단 실습을 통해 이해하는 것이 가장 빠르게 이해할 수 있었다. 

![스크린샷 2022-12-06 22 08 19](https://user-images.githubusercontent.com/104547038/205921038-f4ddb24f-5956-4bb1-ba25-a89d28c2c2ab.png)

예제는 다음과 같다 버튼을 눌렀을 때 "보여줄게 완전히 달라진 값"으로 변화하면 된다. 이를 state 끌어올리기 방법으로 실행하는 것이다. 

```react
import React, { useState } from "react";

export default function ParentComponent() {
  const [value, setValue] = useState("날 바꿔줘!");

  const handleChangeValue = () => {
    setValue("보여줄게 완전히 달라진 값");
  };

  return (
    <div>
      <div>값은 {value} 입니다</div>
      <ChildComponent handleButtonChange={handleChangeValue}/>
    </div>
  );
}

function ChildComponent({handleButtonChange}) {
  const handleClick = () => {
    // 이 버튼을 눌러서 부모의 상태를 바꿀 순 없을까?
    handleButtonChange()
  };

  return <button onClick={handleClick}>값 변경</button>;
}
```

