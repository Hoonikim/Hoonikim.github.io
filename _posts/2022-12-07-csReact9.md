---
layout: single
title: "[React] Effect Hook - 2"
categories: React
tags: [ React, CodeStates]
toc: true


---

### 2022.12.06

### ğŸ’¡  Effect Hook -2

#### ğŸ“Œ Effect Hook ì¡°ê±´ë¶€ ì‹¤í–‰

##### ì¡°ê±´ë¶€ effect ë°œìƒ ( dependency array )

useEffectì˜ ë‘ ë²ˆì§¸ ì¸ìëŠ” ë°°ì—´ì´ë‹¤. ì´ ë°°ì—´ì€ booleaní˜•íƒœì˜ í‘œí˜„ì‹ì´ ì•„ë‹Œ, ì–´ë–¤ ê°’ì˜ ë³€ê²½ì´ ì¼ì–´ë‚  ë•Œì˜ ì¡°ê±´ì„ ì˜ë¯¸í•œë‹¤. 

ë”°ë¼ì„œ í•´ë‹¹ ë°°ì—´ì—” ì–´ë–¤ ê°’ì˜ ëª©ë¡ì´ ë“¤ì–´ê°„ë‹¤. ì´ ë°°ì—´ì„ íŠ¹ë³„íˆ ì¢…ì†ì„± ë°°ì—´ì´ë¼ê³  ë¶€ë¥¸ë‹¤. 

```react
import { useEffect, useState } from "react";
import "./styles.css";
import { getProverbs } from "./storageUtil";

export default function App() {
  const [proverbs, setProverbs] = useState([]);
  const [filter, setFilter] = useState("");
  const [count, setCount] = useState(0);

  useEffect(() => {
    console.log("ì–¸ì œ effect í•¨ìˆ˜ê°€ ë¶ˆë¦´ê¹Œìš”?");
    const result = getProverbs(filter);
    setProverbs(result);
  }, [filter]);

  const handleChange = (e) => {
    setFilter(e.target.value);
  };

  const handleCounterClick = () => {
    setCount(count + 1);
  };

  return (
    <div className="App">
      í•„í„°
      <input type="text" value={filter} onChange={handleChange} />
      <ul>
        {proverbs.map((prvb, i) => (
          <Proverb saying={prvb} key={i} />
        ))}
      </ul>
      <button onClick={handleCounterClick}>ì¹´ìš´í„° ê°’: {count}</button>
    </div>
  );
}

function Proverb({ saying }) {
  return <li>{saying}</li>;
}
```

ì´ ì˜ˆì œëŠ”, `filter`ê°€ ë³€í•  ë•Œì—ë§Œ, effect í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤. í•œí¸, ì¹´ìš´íŠ¸ë¥¼ ì˜¬ë¦¬ëŠ” ë²„íŠ¼ì€ ì»´í¬ë„ŒíŠ¸ì˜ ìƒíƒœê°€ ë°”ë€Œê³  ì—…ë°ì´íŠ¸ë˜ì§€ë§Œ, ì•„ë¬´ë¦¬ ë²„íŠ¼ì„ ëˆŒëŸ¬ë„ effect í•¨ìˆ˜ëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤. ì™œëƒí•˜ë©´, ì¢…ì†ì„± ë°°ì—´ì—ëŠ” `filter`ë§Œ ì¡´ì¬í•˜ê³ , `count`ëŠ” ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸

ì¢…í•©í•´ì„œ ì´ì•¼ê¸°í•˜ë©´ 

> useEffect(í•¨ìˆ˜, [ì¢…ì†ì„±1, ì¢…ì†ì„±2, ...])

`useEffect`ì˜ ë‘ ë²ˆì§¸ ì¸ìëŠ” ì¢…ì†ì„± ë°°ì—´ì´ë‹¤. ë°°ì—´ ë‚´ì˜ ì¢…ì†ì„±1, ë˜ëŠ” ì¢…ì†ì„±2ì˜ ê°’ì´ ë³€í•  ë•Œ, ì²« ë²ˆì§¸ ì¸ìì˜ í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤.

ë°°ì—´ ë‚´ì˜ ì–´ë–¤ ê°’ì´ ë³€í•  ë•Œì—ë§Œ, (effectê°€ ë°œìƒí•˜ëŠ”) í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤.

##### ë‹¨ í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ëŠ” Effect í•¨ìˆ˜ 

ë§Œì¼ ì¢…ì†ì„± ëª©ë¡ì— ì•„ë¬´ëŸ° ì¢…ì†ì„±ë„ ì—†ë‹¤ë©´ ì–´ë–¤ ì¼ì´ ë°œìƒí• ê¹Œ? ë‹¬ë¦¬ ë§í•´, ë‘ ë²ˆì§¸ ë°°ì—´ì„ ë¹ˆ ë°°ì—´ `[ ]`ë¡œ ë‘˜ ê²½ìš°ì—ëŠ” ë¬´ìŠ¨ ì¼ì´ ë°œìƒí• ê¹Œ? ë‘ ë²ˆì§¸ ì¸ìë¥¼ ì•„ì˜ˆ ì•ˆ ë„˜ê¸°ëŠ” ê²ƒê³¼ ì–´ë–»ê²Œ ë‹¤ë¥¼ê¹Œ? 

> 1. ë¹ˆ ë°°ì—´ ë„£ê¸° 
>
>    useEffect( í•¨ìˆ˜, [] )
>
> 2. ì•„ë¬´ê²ƒë„ ë„£ì§€ ì•Šê¸° ( ê¸°ë³¸ í˜•íƒœ )
>
>    useEffect( í•¨ìˆ˜ )

2ë²ˆ ê¸°ë³¸ í˜•íƒœì˜ useEffectëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ìƒì„±ë˜ê±°ë‚˜, propsê°€ ì—…ë°ì´íŠ¸ë˜ê±°ë‚˜, stateê°€ ì—…ë°ì´íŠ¸ë  ë•Œ effect í•¨ìˆ˜ê°€ ì‹¤í–‰ë¨ì„ ì•ì„œ ë°°ì› ë‹¤. 

ë°˜ë©´ 1ë²ˆ ë¹ˆ ë°°ì—´ì„ useEffectì˜ ë‘ ë²ˆì§¸ ì¸ìë¡œ ì‚¬ìš©í•˜ë©´, ì´ë•Œì—ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ìƒì„±ë  ë•Œë§Œ effect í•¨ìˆ˜ê°€ ì‹¤í–‰ëœë‹¤. ì´ê²ƒì´ ì–¸ì œ í•„ìš”í• ê¹Œ? 

ëŒ€í‘œì ìœ¼ë¡œ ì²˜ìŒ ë‹¨ í•œ ë²ˆ, ì™¸ë¶€ APIë¥¼ í†µí•´ ë¦¬ì†ŒìŠ¤ë¥¼ ë°›ì•„ì˜¤ê³  ë” ì´ìƒ API í˜¸ì¶œì´ í•„ìš”í•˜ì§€ ì•Šì„ ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. 

#### ğŸ“Œ ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œì˜ Ajax ìš”ì²­ 

ëª©ë¡ ë‚´ í•„í„°ë§ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‘ ê°€ì§€ ì ‘ê·¼ì´ ìˆë‹¤.

1. **ì»´í¬ë„ŒíŠ¸ ë‚´ì—ì„œ í•„í„°ë§**: ì „ì²´ ëª©ë¡ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê³ , ëª©ë¡ì„ ê²€ìƒ‰ì–´ë¡œ filter í•˜ëŠ” ë°©ë²•
2. **ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì—ì„œ í•„í„°ë§**: ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ë¡œ API ìš”ì²­ì„ í•  ë•Œ, í•„í„°ë§ í•œ ê²°ê³¼ë¥¼ ë°›ì•„ì˜¤ëŠ” ë°©ë²• (ë³´í†µ, ì„œë²„ì— ë§¤ë²ˆ ê²€ìƒ‰ì–´ì™€ í•¨ê»˜ ìš”ì²­í•˜ëŠ” ê²½ìš°ê°€ ì´ì— í•´ë‹¹)

ê°ê°ì˜ ì¥ë‹¨ì ì€ ë¬´ì—‡ì¼ê¹Œ? ì§€ê¸ˆì€, ìš°ë¦¬ê°€ `storageUtil.js`ë¥¼ ì´ìš©í•´ ì™¸ë¶€ APIë¥¼ ì§ì ‘ êµ¬í˜„í–ˆì§€ë§Œ(LocalStorage APIë¥¼ ì´ìš©), ì´ëŠ” **ì„œë²„ ìš”ì²­**ìœ¼ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤. ë§Œì¼ ì„œë²„ì—ì„œ ìˆ˜ì‹­ë§Œ ê°œì˜ ëª…ì–¸ì„ ì œê³µí•œë‹¤ê³  ê°€ì •í•´ ë³´ì. ë‹¤ìŒì˜ í‘œëŠ” HTTPë¥¼ ì´ìš©í•œ ì„œë²„ ìš”ì²­ì„ ê°€ì •í•  ë•Œ, ë‘ ë°©ì‹ì˜ ì°¨ì´ì ì„ ì„¤ëª…í•œë‹¤.

![ìŠ¤í¬ë¦°ìƒ· 2022-12-07 14 03 33](https://user-images.githubusercontent.com/104547038/206092976-693a8680-e1f6-406f-a4bf-9e88203a17fa.png)

##### Ajaxìš”ì²­ì„ ë³´ë‚´ë³´ì 

```react
useEffect(() => {
  fetch(`http://ì„œë²„ì£¼ì†Œ/proverbs?q=${filter}`)
    .then(resp => resp.json())
    .then(result => {
      setProverbs(result);
    });
}, [filter]);
```

##### Ajax ìš”ì²­ì´ ë§¤ìš° ëŠë¦´ ê²½ìš°? 

ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ìš”ì²­ì´ í•­ìƒ ì¦‰ê°ì ì¸ ì‘ë‹µì„ ê°€ì ¸ë‹¤ì£¼ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ì™¸ë¶€ API ì ‘ì†ì´ ëŠë¦´ ê²½ìš°ë¥¼ ê³ ë ¤í•˜ì—¬ ë¡œë”©í˜ì´ì§€ì˜ êµ¬í˜„ì€ í•„ìˆ˜ì ì´ë‹¤. 

```react
const [isLoading, setIsLoading] = useState(true);

// ìƒëµ, LoadingIndicator ì»´í¬ë„ŒíŠ¸ëŠ” ë³„ë„ë¡œ êµ¬í˜„í–ˆìŒì„ ê°€ì •í•©ë‹ˆë‹¤
return {isLoading ? <LoadingIndicator /> : <div>ë¡œë”© ì™„ë£Œ í™”ë©´</div>}
```

fetch ìš”ì²­ ì „í›„ë¡œ setIsLoadingì„ ì„¤ì •í•´ì£¼ì–´ ë³´ë‹¤ ë‚˜ì€ UXë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. 

```react
useEffect(() => {
  setIsLoading(true);
  fetch(`http://ì„œë²„ì£¼ì†Œ/proverbs?q=${filter}`)
    .then(resp => resp.json())
    .then(result => {
      setProverbs(result);
      setIsLoading(false);
    });
}, [filter]);
```

